document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("fileInput"),e=document.getElementById("convertButton"),n=document.getElementById("downloadLink");async function a(t){try{let e=new(window.AudioContext||window.webkitAudioContext),n=await t.arrayBuffer(),a=await e.decodeAudioData(n),l=function t(e){let n=e.numberOfChannels,a=e.sampleRate,l=e.length*n,r=new ArrayBuffer(44+2*l),o=new DataView(r);return i(o,0,"RIFF"),o.setUint32(4,36+2*l,!0),i(o,8,"WAVE"),i(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,n,!0),o.setUint32(24,a,!0),o.setUint32(28,a*n*2,!0),o.setUint16(32,2*n,!0),o.setUint16(34,16,!0),i(o,36,"data"),o.setUint32(40,2*l,!0),function t(e,n,a){for(let i=0;i<a.numberOfChannels;i++){let l=a.getChannelData(i);for(let r=0;r<l.length;r++,n+=2){let o=Math.max(-1,Math.min(1,l[r]));e.setInt16(n,o<0?32768*o:32767*o,!0)}}}(o,44,e),r}(a);return new Blob([l],{type:"audio/wav"})}catch(r){return console.error("Error converting to wav:",r),null}}function i(t,e,n){for(let a=0;a<n.length;a++)t.setUint8(e+a,n.charCodeAt(a))}e.addEventListener("click",async()=>{let e=t.files[0];if(!e)return;let i=await a(e);i&&(n.href=URL.createObjectURL(i),n.download=e.name.replace(/\.[^/.]+$/,"")+".wav",n.style.display="block")})});